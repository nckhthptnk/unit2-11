<!doctype html>
<html lang="vi" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unit 2: Vietnam and ASEAN</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .flashcard {
            perspective: 1000px;
            height: 280px;
        }
        
        @media (min-width: 640px) {
            .flashcard {
                height: 350px;
            }
        }
        
        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        
        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 16px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        @media (min-width: 640px) {
            .flashcard-front, .flashcard-back {
                border-radius: 16px;
                padding: 24px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            }
        }
        
        .flashcard-back {
            transform: rotateY(180deg);
        }
        
        .highlight {
            background-color: #fef08a;
            padding: 2px 4px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .tab-button {
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }
        
        .tab-button.active {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .tab-button:active {
            transform: scale(0.95);
        }
        
        /* Mobile button improvements */
        @media (max-width: 640px) {
            .tab-button.active {
                transform: none;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
        }
        
        /* General button touch improvements */
        button {
            -webkit-tap-highlight-color: transparent;
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        .grammar-topic {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .grammar-topic:hover {
            transform: translateX(8px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .quiz-option {
            transition: all 0.2s ease;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }
        
        .quiz-option:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .quiz-option:active {
            transform: scale(0.98);
        }
        
        /* Mobile touch improvements */
        @media (max-width: 640px) {
            .quiz-option:hover {
                transform: none;
                box-shadow: none;
            }
            
            .quiz-option:active {
                transform: scale(0.98);
                background-color: rgba(0,0,0,0.05);
            }
        }
        
        .correct {
            background-color: #dcfce7 !important;
            border-color: #16a34a !important;
            animation: correctPulse 0.5s ease;
        }
        
        .incorrect {
            background-color: #fef2f2 !important;
            border-color: #dc2626 !important;
            animation: incorrectShake 0.5s ease;
        }
        
        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-gradient-to-br from-blue-50 to-indigo-100 font-sans">
  <div class="min-h-full p-2 sm:p-4"><!-- Header -->
   <header class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-4 sm:mb-6"><!-- Home button -->
    <div class="mb-4"><a href="https://nckhthptnk.github.io/tienganh11/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center bg-indigo-600 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm sm:text-base"> üè† <span class="ml-1 sm:ml-2" id="home-button-text">Trang ch·ªß</span> </a>
    </div><!-- Title -->
    <div class="text-center mb-6">
     <h1 id="unit-title" class="text-lg sm:text-2xl lg:text-3xl font-bold text-indigo-800 mb-2">Unit 2: Vietnam and ASEAN</h1>
     <p id="welcome-message" class="text-xs sm:text-sm lg:text-base text-gray-600 font-medium">Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi b√†i h·ªçc Ti·∫øng Anh c√πng Mega Master 11 nh√©!</p>
    </div><!-- Progress Section -->
    <div class="bg-gray-50 rounded-lg p-4 sm:p-6">
     <h2 class="text-base sm:text-lg font-semibold text-gray-800 mb-4 text-center">üìä Ti·∫øn ƒë·ªô h·ªçc t·∫≠p</h2>
     <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 lg:gap-4">
      <div class="text-center bg-white rounded-lg p-2 sm:p-3 shadow-sm">
       <div class="text-base sm:text-lg lg:text-xl font-bold text-indigo-600" id="total-progress">
        0%
       </div>
       <div class="text-xs text-gray-600">
        T·ªïng
       </div>
       <div class="w-full bg-gray-200 rounded-full h-1.5 sm:h-2 mt-1 sm:mt-2">
        <div class="bg-indigo-600 h-1.5 sm:h-2 rounded-full progress-bar" id="total-bar" style="width: 0%"></div>
       </div>
      </div>
      <div class="text-center bg-white rounded-lg p-2 sm:p-3 shadow-sm">
       <div class="text-base sm:text-lg lg:text-xl font-bold text-green-600" id="vocab-progress">
        0%
       </div>
       <div class="text-xs text-gray-600">
        T·ª´ v·ª±ng
       </div>
       <div class="w-full bg-gray-200 rounded-full h-1.5 sm:h-2 mt-1 sm:mt-2">
        <div class="bg-green-600 h-1.5 sm:h-2 rounded-full progress-bar" id="vocab-bar" style="width: 0%"></div>
       </div>
      </div>
      <div class="text-center bg-white rounded-lg p-2 sm:p-3 shadow-sm">
       <div class="text-base sm:text-lg lg:text-xl font-bold text-blue-600" id="reading-progress">
        0%
       </div>
       <div class="text-xs text-gray-600">
        B√†i ƒë·ªçc
       </div>
       <div class="w-full bg-gray-200 rounded-full h-1.5 sm:h-2 mt-1 sm:mt-2">
        <div class="bg-blue-600 h-1.5 sm:h-2 rounded-full progress-bar" id="reading-bar" style="width: 0%"></div>
       </div>
      </div>
      <div class="text-center bg-white rounded-lg p-2 sm:p-3 shadow-sm">
       <div class="text-base sm:text-lg lg:text-xl font-bold text-purple-600" id="grammar-progress">
        0%
       </div>
       <div class="text-xs text-gray-600">
        Ng·ªØ ph√°p
       </div>
       <div class="w-full bg-gray-200 rounded-full h-1.5 sm:h-2 mt-1 sm:mt-2">
        <div class="bg-purple-600 h-1.5 sm:h-2 rounded-full progress-bar" id="grammar-bar" style="width: 0%"></div>
       </div>
      </div>
     </div>
    </div>
   </header><!-- Navigation Tabs -->
   <div class="bg-white rounded-lg shadow-lg p-2 mb-6">
    <div class="flex flex-col sm:flex-row gap-2"><button id="vocab-tab" class="tab-button flex-1 bg-green-500 text-white px-4 py-3 rounded-lg font-semibold text-sm sm:text-base active"> üìö T·ª´ v·ª±ng </button> <button id="reading-tab" class="tab-button flex-1 bg-gray-200 text-gray-700 px-4 py-3 rounded-lg font-semibold text-sm sm:text-base"> üìñ B√†i ƒë·ªçc </button> <button id="grammar-tab" class="tab-button flex-1 bg-gray-200 text-gray-700 px-4 py-3 rounded-lg font-semibold text-sm sm:text-base"> üìù Ng·ªØ ph√°p </button>
    </div>
   </div><!-- Content Sections -->
   <main class="bg-white rounded-lg shadow-lg p-4 sm:p-6"><!-- Vocabulary Section -->
    <div id="vocab-section" class="fade-in">
     <h2 class="text-lg sm:text-xl font-bold text-green-600 mb-6 text-center">üìö T·ª´ v·ª±ng - Vietnam Tourism &amp; Culture</h2><!-- Vocabulary Mode Toggle -->
     <div class="flex flex-col sm:flex-row justify-center gap-2 sm:gap-4 mb-6 px-4"><button id="flashcard-mode" class="bg-green-500 text-white px-4 py-2 sm:px-6 sm:py-2 rounded-lg font-semibold transition-colors text-sm sm:text-base"> üìö H·ªçc t·ª´ v·ª±ng </button> <button id="vocab-quiz-mode" class="bg-orange-500 text-white px-4 py-2 sm:px-6 sm:py-2 rounded-lg font-semibold transition-colors text-sm sm:text-base"> üß† Ki·ªÉm tra t·ª´ v·ª±ng </button>
     </div><!-- Flashcard Mode -->
     <div id="flashcard-container"><!-- Flashcard -->
      <div class="max-w-2xl mx-auto mb-6">
       <div class="flashcard" id="flashcard">
        <div class="flashcard-inner">
         <div class="flashcard-front bg-gradient-to-br from-green-400 to-green-600 text-white">
          <div class="text-lg sm:text-xl lg:text-2xl font-bold mb-3 text-center" id="vocab-word">
           take away
          </div>
          <div class="text-sm sm:text-base opacity-90 text-center" id="vocab-ipa">
           /te…™k …ôÀàwe…™/
          </div>
          <div class="text-xs opacity-80 mt-2 text-center" id="vocab-type">
           (phrasal verb)
          </div>
         </div>
         <div class="flashcard-back bg-gradient-to-br from-blue-400 to-blue-600 text-white">
          <div class="text-base sm:text-lg lg:text-xl font-bold mb-3 text-center" id="vocab-meaning">
           mang ƒëi, l·∫•y ƒëi
          </div>
          <div class="text-xs sm:text-sm italic opacity-90 text-center px-2" id="vocab-example">
           "Please take away these dishes after dinner."
          </div>
          <div class="text-xs opacity-80 mt-2 text-center px-2" id="vocab-example-vi">
           "H√£y d·ªçn nh·ªØng chi·∫øc ƒëƒ©a n√†y sau b·ªØa t·ªëi."
          </div>
         </div>
        </div>
       </div>
      </div><!-- Controls -->
      <div class="flex justify-center items-center gap-2 sm:gap-4 mb-6 px-4"><button id="prev-vocab" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg font-semibold transition-colors text-sm sm:text-base"> ‚Üê L√πi </button> <button id="flip-card" class="bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 sm:px-6 sm:py-2 rounded-lg font-semibold transition-colors text-sm sm:text-base"> üîÑ <span class="hidden sm:inline">L·∫≠t (Space)</span><span class="sm:hidden">L·∫≠t</span> </button> <button id="next-vocab" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg font-semibold transition-colors text-sm sm:text-base"> Ti·∫øp ‚Üí </button>
      </div><!-- Vocabulary Progress -->
      <div class="text-center"><span class="text-gray-600" id="vocab-counter">1 / 41</span>
      </div>
     </div><!-- Vocabulary Quiz Mode -->
     <div id="vocab-quiz-container" class="hidden">
      <div class="bg-orange-50 rounded-lg p-4 sm:p-6">
       <h3 class="text-lg font-semibold mb-4 text-center">Ki·ªÉm tra t·ª´ v·ª±ng - 41 c√¢u h·ªèi</h3>
       <div class="mb-4 text-center"><span class="text-sm text-gray-600">C√¢u <span id="current-vocab-question">1</span> / 41</span>
        <div class="text-sm text-gray-600 mt-1">
         ƒêi·ªÉm: <span id="vocab-quiz-score">0</span>/41
        </div>
       </div>
       <div id="vocab-quiz-question" class="bg-white p-6 rounded-lg border"><!-- Question will be loaded here -->
       </div>
       <div class="flex justify-between mt-4 gap-2"><button id="prev-vocab-question" class="bg-gray-500 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base" disabled>‚Üê C√¢u tr∆∞·ªõc</button> <button id="next-vocab-question" class="bg-orange-500 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base">C√¢u ti·∫øp ‚Üí</button>
       </div>
      </div>
     </div>
    </div><!-- Reading Section -->
    <div id="reading-section" class="hidden">
     <h2 class="text-lg sm:text-xl font-bold text-blue-600 mb-6 text-center">üìñ B√†i ƒë·ªçc - Vietnam and ASEAN</h2><!-- Reading Mode Selection -->
     <div class="flex flex-col sm:flex-row justify-center gap-2 sm:gap-4 mb-6 px-4"><button id="reading-mode" class="bg-blue-500 text-white px-4 py-2 sm:px-6 sm:py-2 rounded-lg font-semibold transition-colors text-sm sm:text-base"> üìñ B√†i ƒë·ªçc </button> <button id="asean-mode" class="bg-orange-500 text-white px-4 py-2 sm:px-6 sm:py-2 rounded-lg font-semibold transition-colors text-sm sm:text-base"> üåè C√°c n∆∞·ªõc ASEAN </button>
     </div><!-- Reading Passage Container -->
     <div id="reading-container"><!-- Reading Passage -->
      <div class="bg-gray-50 rounded-lg p-4 sm:p-6 mb-6">
       <h3 class="text-base sm:text-lg font-semibold mb-4 text-center">Vietnam's Tourism and Cultural Heritage</h3>
       <div class="text-xs sm:text-sm leading-relaxed text-justify" id="reading-passage">
        Vietnam is a <span class="highlight">picturesque</span> country with diverse landscapes, from towering <span class="highlight">mountains</span> to pristine <span class="highlight">bays</span>. Ha Long Bay, with its limestone islands, is <span class="highlight">another</span> UNESCO World Heritage site that attracts millions of visitors. The country's <span class="highlight">historical</span> sites include ancient <span class="highlight">temples</span>, magnificent <span class="highlight">palaces</span>, and sacred <span class="highlight">pagodas</span> where people <span class="highlight">worship</span> their ancestors. Hue's Imperial <span class="highlight">Citadel</span> showcases Vietnam's royal <span class="highlight">architecture</span>, while the <span class="highlight">tomb</span> of Emperor Khai Dinh reflects French colonial influence. Vietnamese <span class="highlight">culture</span> is rich and diverse, with each region offering unique <span class="highlight">flavours</span> in local food <span class="highlight">stalls</span>. Visitors should <span class="highlight">take off</span> their shoes before entering religious sites to show respect. Tour guides often <span class="highlight">explain</span> the <span class="highlight">wisdom</span> behind ancient traditions and <span class="highlight">recommend</span> must-visit <span class="highlight">tourist attractions</span>. From the sand <span class="highlight">dunes</span> of Mui Ne to the peaceful <span class="highlight">valleys</span> of Sapa, Vietnam offers breathtaking natural beauty. The country continues to <span class="highlight">conserve</span> its heritage while welcoming travelers to experience its <span class="highlight">popular</span> destinations. Each <span class="highlight">symbol</span> and tradition tells a story of Vietnam's rich past and promising future.
       </div>
      </div><!-- Reading Quiz -->
      <div class="bg-blue-50 rounded-lg p-4 sm:p-6">
       <h3 class="text-base font-semibold mb-4 text-center">C√¢u h·ªèi hi·ªÉu b√†i ƒë·ªçc</h3>
       <div id="reading-quiz"><!-- Quiz questions will be generated here -->
       </div>
       <div class="text-center mt-4">
        <div class="text-sm text-gray-600" id="reading-score">
         ƒêi·ªÉm: 0/5
        </div>
       </div>
      </div>
     </div><!-- ASEAN Countries Container -->
     <div id="asean-container" class="hidden">
      <div class="bg-orange-50 rounded-lg p-4 sm:p-6">
       <h3 class="text-base sm:text-lg font-semibold mb-6 text-center">üåè C√°c n∆∞·ªõc th√†nh vi√™n ASEAN</h3>
       <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4" id="asean-countries"><!-- Countries will be loaded here -->
       </div>
      </div>
     </div>
    </div><!-- Grammar Section -->
    <div id="grammar-section" class="hidden">
     <h2 class="text-lg sm:text-xl font-bold text-purple-600 mb-6 text-center">üìù Ng·ªØ ph√°p</h2><!-- Grammar Topics -->
     <div class="grid gap-4 mb-6">
      <div class="grammar-topic bg-purple-50 border border-purple-200 rounded-lg p-4 hover:bg-purple-100" data-topic="past-continuous">
       <h3 class="text-sm sm:text-base font-semibold text-purple-800">Past Continuous Tense</h3>
       <p class="text-xs sm:text-sm text-purple-600 mt-1">Th√¨ qu√° kh·ª© ti·∫øp di·ªÖn</p>
      </div>
      <div class="grammar-topic bg-purple-50 border border-purple-200 rounded-lg p-4 hover:bg-purple-100" data-topic="cleft-sentence">
       <h3 class="text-sm sm:text-base font-semibold text-purple-800">Cleft Sentences</h3>
       <p class="text-xs sm:text-sm text-purple-600 mt-1">C√¢u ch·∫ª (It is/was... that/who...)</p>
      </div>
      <div class="grammar-topic bg-purple-50 border border-purple-200 rounded-lg p-4 hover:bg-purple-100" data-topic="articles">
       <h3 class="text-sm sm:text-base font-semibold text-purple-800">Articles (a/an/the)</h3>
       <p class="text-xs sm:text-sm text-purple-600 mt-1">M·∫°o t·ª´</p>
      </div>
      <div class="grammar-topic bg-purple-50 border border-purple-200 rounded-lg p-4 hover:bg-purple-100" data-topic="its-time">
       <h3 class="text-sm sm:text-base font-semibold text-purple-800">It's time</h3>
       <p class="text-xs sm:text-sm text-purple-600 mt-1">C·∫•u tr√∫c "It's time"</p>
      </div>
      <div class="grammar-topic bg-purple-50 border border-purple-200 rounded-lg p-4 hover:bg-purple-100" data-topic="would-rather">
       <h3 class="text-sm sm:text-base font-semibold text-purple-800">Would rather</h3>
       <p class="text-xs sm:text-sm text-purple-600 mt-1">C·∫•u tr√∫c "Would rather"</p>
      </div>
      <div class="grammar-topic bg-red-50 border border-red-200 rounded-lg p-4 hover:bg-red-100" data-topic="comprehensive-test">
       <h3 class="text-sm sm:text-base font-semibold text-red-800">üéØ B√†i t·∫≠p t·ªïng h·ª£p</h3>
       <p class="text-xs sm:text-sm text-red-600 mt-1">30 c√¢u tr·∫Øc nghi·ªám t·ªïng h·ª£p</p>
      </div>
     </div><!-- Grammar Content -->
     <div id="grammar-content" class="bg-purple-50 rounded-lg p-4 sm:p-6 hidden"><!-- Content will be loaded dynamically -->
     </div>
    </div>
   </main>
  </div>
  <script>
        // Data and State Management
        let currentData = {
            vocabulary_progress: 0,
            reading_progress: 0,
            grammar_progress: 0,
            current_vocab_index: 0,
            completed_reading: false,
            completed_grammar_topics: '',
            quiz_scores: ''
        };

        // Default configuration
        const defaultConfig = {
            unit_title: "Unit 2: Vietnam and ASEAN",
            welcome_message: "Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi b√†i h·ªçc Ti·∫øng Anh c√πng Mega Master 11 nh√©!",
            home_button_text: "Trang ch·ªß",
            background_color: "#f0f9ff",
            surface_color: "#ffffff",
            text_color: "#1f2937",
            primary_color: "#4f46e5",
            accent_color: "#10b981"
        };

        // Vocabulary data
        const vocabularyData = [
            {
                word: "take away",
                ipa: "/te…™k …ôÀàwe…™/",
                type: "(phrasal verb)",
                meaning: "mang ƒëi, l·∫•y ƒëi",
                example: "Please take away these dishes after dinner.",
                exampleVi: "H√£y d·ªçn nh·ªØng chi·∫øc ƒëƒ©a n√†y sau b·ªØa t·ªëi."
            },
            {
                word: "conserve",
                ipa: "/k…ônÀàs…úÀêrv/",
                type: "(verb)",
                meaning: "b·∫£o t·ªìn, gi·ªØ g√¨n",
                example: "We must conserve our natural heritage.",
                exampleVi: "Ch√∫ng ta ph·∫£i b·∫£o t·ªìn di s·∫£n thi√™n nhi√™n."
            },
            {
                word: "historical",
                ipa: "/h…™Ààst…îÀêr…™k…ôl/",
                type: "(adjective)",
                meaning: "thu·ªôc v·ªÅ l·ªãch s·ª≠",
                example: "This is a historical monument from the 15th century.",
                exampleVi: "ƒê√¢y l√† m·ªôt di t√≠ch l·ªãch s·ª≠ t·ª´ th·∫ø k·ª∑ 15."
            },
            {
                word: "picturesque",
                ipa: "/Àåp…™kt É…ôÀàresk/",
                type: "(adjective)",
                meaning: "ƒë·∫πp nh∆∞ tranh",
                example: "The village is very picturesque with old houses.",
                exampleVi: "Ng√¥i l√†ng r·∫•t ƒë·∫πp nh∆∞ tranh v·ªõi nh·ªØng ng√¥i nh√† c·ªï."
            },
            {
                word: "another",
                ipa: "/…ôÀàn å√∞…ôr/",
                type: "(determiner)",
                meaning: "m·ªôt c√°i kh√°c",
                example: "Would you like another cup of coffee?",
                exampleVi: "B·∫°n c√≥ mu·ªën th√™m m·ªôt t√°ch c√† ph√™ n·ªØa kh√¥ng?"
            },
            {
                word: "other",
                ipa: "/Àà å√∞…ôr/",
                type: "(determiner)",
                meaning: "kh√°c",
                example: "I prefer this book to the other one.",
                exampleVi: "T√¥i th√≠ch cu·ªën s√°ch n√†y h∆°n cu·ªën kia."
            },
            {
                word: "others",
                ipa: "/Àà å√∞…ôrz/",
                type: "(pronoun)",
                meaning: "nh·ªØng c√°i kh√°c",
                example: "Some students passed, but others failed.",
                exampleVi: "M·ªôt s·ªë h·ªçc sinh ƒë·∫≠u, nh∆∞ng nh·ªØng ng∆∞·ªùi kh√°c tr∆∞·ª£t."
            },
            {
                word: "the other",
                ipa: "/√∞i Àà å√∞…ôr/",
                type: "(determiner)",
                meaning: "c√°i c√≤n l·∫°i",
                example: "I have two books. This is one, where is the other?",
                exampleVi: "T√¥i c√≥ hai cu·ªën s√°ch. ƒê√¢y l√† m·ªôt cu·ªën, cu·ªën c√≤n l·∫°i ƒë√¢u?"
            },
            {
                word: "the others",
                ipa: "/√∞i Àà å√∞…ôrz/",
                type: "(pronoun)",
                meaning: "nh·ªØng c√°i c√≤n l·∫°i",
                example: "Three students left early, the others stayed.",
                exampleVi: "Ba h·ªçc sinh v·ªÅ s·ªõm, nh·ªØng ng∆∞·ªùi c√≤n l·∫°i ·ªü l·∫°i."
            },
            {
                word: "each other",
                ipa: "/iÀêt É Àà å√∞…ôr/",
                type: "(pronoun)",
                meaning: "l·∫´n nhau (2 ng∆∞·ªùi)",
                example: "The two friends help each other.",
                exampleVi: "Hai ng∆∞·ªùi b·∫°n gi√∫p ƒë·ª° l·∫´n nhau."
            },
            {
                word: "one another",
                ipa: "/w ån …ôÀàn å√∞…ôr/",
                type: "(pronoun)",
                meaning: "l·∫´n nhau (3+ ng∆∞·ªùi)",
                example: "The team members support one another.",
                exampleVi: "C√°c th√†nh vi√™n trong ƒë·ªôi h·ªó tr·ª£ l·∫´n nhau."
            },
            {
                word: "mountain",
                ipa: "/Ààma änt…ôn/",
                type: "(noun)",
                meaning: "n√∫i",
                example: "Fansipan is the highest mountain in Vietnam.",
                exampleVi: "Fansipan l√† ng·ªçn n√∫i cao nh·∫•t Vi·ªát Nam."
            },
            {
                word: "valley",
                ipa: "/Ààv√¶li/",
                type: "(noun)",
                meaning: "thung l≈©ng",
                example: "The valley is surrounded by high mountains.",
                exampleVi: "Thung l≈©ng ƒë∆∞·ª£c bao quanh b·ªüi nh·ªØng ng·ªçn n√∫i cao."
            },
            {
                word: "dune",
                ipa: "/duÀên/",
                type: "(noun)",
                meaning: "ƒë·ªìi c√°t",
                example: "The sand dunes in Mui Ne are spectacular.",
                exampleVi: "Nh·ªØng ƒë·ªìi c√°t ·ªü M≈©i N√© r·∫•t ngo·∫°n m·ª•c."
            },
            {
                word: "bay",
                ipa: "/be…™/",
                type: "(noun)",
                meaning: "v·ªãnh",
                example: "Ha Long Bay is famous for its limestone islands.",
                exampleVi: "V·ªãnh H·∫° Long n·ªïi ti·∫øng v·ªõi nh·ªØng ƒë·∫£o ƒë√° v√¥i."
            },
            {
                word: "cave",
                ipa: "/ke…™v/",
                type: "(noun)",
                meaning: "hang ƒë·ªông",
                example: "Son Tra Cave is one of the largest caves in the world.",
                exampleVi: "Hang S∆°n Tr√† l√† m·ªôt trong nh·ªØng hang ƒë·ªông l·ªõn nh·∫•t th·∫ø gi·ªõi."
            },
            {
                word: "waterfall",
                ipa: "/Ààw…îÀêt…ôrf…îÀêl/",
                type: "(noun)",
                meaning: "th√°c n∆∞·ªõc",
                example: "Ban Gioc waterfall is on the border with China.",
                exampleVi: "Th√°c Ban Gi·ªëc n·∫±m ·ªü bi√™n gi·ªõi v·ªõi Trung Qu·ªëc."
            },
            {
                word: "architecture",
                ipa: "/Àà…ëÀêrk…™tekt É…ôr/",
                type: "(noun)",
                meaning: "ki·∫øn tr√∫c",
                example: "Vietnamese architecture reflects French influence.",
                exampleVi: "Ki·∫øn tr√∫c Vi·ªát Nam ph·∫£n √°nh ·∫£nh h∆∞·ªüng c·ªßa Ph√°p."
            },
            {
                word: "cathedral",
                ipa: "/k…ôÀàŒ∏iÀêdr…ôl/",
                type: "(noun)",
                meaning: "nh√† th·ªù l·ªõn",
                example: "Notre Dame Cathedral is in Ho Chi Minh City.",
                exampleVi: "Nh√† th·ªù ƒê·ª©c B√† ·ªü th√†nh ph·ªë H·ªì Ch√≠ Minh."
            },
            {
                word: "pagoda",
                ipa: "/p…ôÀà…°o äd…ô/",
                type: "(noun)",
                meaning: "ch√πa",
                example: "The One Pillar Pagoda is a historic temple in Hanoi.",
                exampleVi: "Ch√πa M·ªôt C·ªôt l√† m·ªôt ng√¥i ch√πa l·ªãch s·ª≠ ·ªü H√† N·ªôi."
            },
            {
                word: "tower",
                ipa: "/Ààta ä…ôr/",
                type: "(noun)",
                meaning: "th√°p",
                example: "The Bitexco Tower is the tallest building in Ho Chi Minh City.",
                exampleVi: "Th√°p Bitexco l√† t√≤a nh√† cao nh·∫•t ·ªü th√†nh ph·ªë H·ªì Ch√≠ Minh."
            },
            {
                word: "citadel",
                ipa: "/Ààs…™t…ôd…ôl/",
                type: "(noun)",
                meaning: "th√†nh, kinh th√†nh",
                example: "Hue Citadel was the imperial capital of Vietnam.",
                exampleVi: "Kinh th√†nh Hu·∫ø l√† kinh ƒë√¥ ho√†ng gia c·ªßa Vi·ªát Nam."
            },
            {
                word: "palace",
                ipa: "/Ààp√¶l…ôs/",
                type: "(noun)",
                meaning: "cung ƒëi·ªán",
                example: "The Imperial Palace in Hue is magnificent.",
                exampleVi: "Cung ƒëi·ªán Ho√†ng gia ·ªü Hu·∫ø r·∫•t tr√°ng l·ªá."
            },
            {
                word: "tomb",
                ipa: "/tuÀêm/",
                type: "(noun)",
                meaning: "lƒÉng m·ªô",
                example: "Ho Chi Minh's tomb is in Ba Dinh Square.",
                exampleVi: "LƒÉng Ch·ªß t·ªãch H·ªì Ch√≠ Minh ·ªü Qu·∫£ng tr∆∞·ªùng Ba ƒê√¨nh."
            },
            {
                word: "tourist attraction",
                ipa: "/Ààt är…™st …ôÀàtr√¶k É…ôn/",
                type: "(noun)",
                meaning: "ƒëi·ªÉm thu h√∫t kh√°ch du l·ªãch",
                example: "Ha Long Bay is a major tourist attraction.",
                exampleVi: "V·ªãnh H·∫° Long l√† m·ªôt ƒëi·ªÉm thu h√∫t kh√°ch du l·ªãch l·ªõn."
            },
            {
                word: "symbol",
                ipa: "/Ààs…™mb…ôl/",
                type: "(noun)",
                meaning: "bi·ªÉu t∆∞·ª£ng",
                example: "The lotus is a symbol of purity in Vietnamese culture.",
                exampleVi: "Hoa sen l√† bi·ªÉu t∆∞·ª£ng c·ªßa s·ª± thu·∫ßn khi·∫øt trong vƒÉn h√≥a Vi·ªát."
            },
            {
                word: "worship",
                ipa: "/Ààw…úÀêr É…™p/",
                type: "(verb)",
                meaning: "th·ªù c√∫ng, t√¥n th·ªù",
                example: "Vietnamese people worship their ancestors.",
                exampleVi: "Ng∆∞·ªùi Vi·ªát th·ªù c√∫ng t·ªï ti√™n."
            },
            {
                word: "flavour",
                ipa: "/Ààfle…™v…ôr/",
                type: "(noun)",
                meaning: "h∆∞∆°ng v·ªã",
                example: "Vietnamese pho has a unique flavour.",
                exampleVi: "Ph·ªü Vi·ªát Nam c√≥ h∆∞∆°ng v·ªã ƒë·ªôc ƒë√°o."
            },
            {
                word: "stall",
                ipa: "/st…îÀêl/",
                type: "(noun)",
                meaning: "qu·∫ßy h√†ng, gian h√†ng",
                example: "There are many food stalls in Ben Thanh Market.",
                exampleVi: "C√≥ nhi·ªÅu qu·∫ßy th·ª©c ƒÉn ·ªü ch·ª£ B·∫øn Th√†nh."
            },
            {
                word: "wisdom",
                ipa: "/Ààw…™zd…ôm/",
                type: "(noun)",
                meaning: "tr√≠ tu·ªá",
                example: "Ancient wisdom is preserved in Vietnamese proverbs.",
                exampleVi: "Tr√≠ tu·ªá c·ªï x∆∞a ƒë∆∞·ª£c b·∫£o t·ªìn trong t·ª•c ng·ªØ Vi·ªát Nam."
            },
            {
                word: "recommend",
                ipa: "/Àårek…ôÀàmend/",
                type: "(verb)",
                meaning: "khuy√™n, gi·ªõi thi·ªáu",
                example: "I recommend visiting Hoi An ancient town.",
                exampleVi: "T√¥i khuy√™n n√™n thƒÉm ph·ªë c·ªï H·ªôi An."
            },
            {
                word: "take off",
                ipa: "/te…™k …îÀêf/",
                type: "(phrasal verb)",
                meaning: "c·ªüi ra, kh·ªüi h√†nh",
                example: "Please take off your shoes before entering the temple.",
                exampleVi: "H√£y c·ªüi gi√†y tr∆∞·ªõc khi v√†o ch√πa."
            },
            {
                word: "culture",
                ipa: "/Ààk ålt É…ôr/",
                type: "(noun)",
                meaning: "vƒÉn h√≥a",
                example: "Vietnamese culture is rich and diverse.",
                exampleVi: "VƒÉn h√≥a Vi·ªát Nam phong ph√∫ v√† ƒëa d·∫°ng."
            },
            {
                word: "explain",
                ipa: "/…™kÀàsple…™n/",
                type: "(verb)",
                meaning: "gi·∫£i th√≠ch",
                example: "The guide will explain the history of the temple.",
                exampleVi: "H∆∞·ªõng d·∫´n vi√™n s·∫Ω gi·∫£i th√≠ch l·ªãch s·ª≠ c·ªßa ng√¥i ch√πa."
            },
            {
                word: "historic",
                ipa: "/h…™Ààst…îÀêr…™k/",
                type: "(adjective)",
                meaning: "c√≥ √Ω nghƒ©a l·ªãch s·ª≠",
                example: "This is a historic moment for our country.",
                exampleVi: "ƒê√¢y l√† m·ªôt kho·∫£nh kh·∫Øc l·ªãch s·ª≠ cho ƒë·∫•t n∆∞·ªõc ch√∫ng ta."
            },
            {
                word: "locate",
                ipa: "/Ààlo äke…™t/",
                type: "(verb)",
                meaning: "ƒë·ªãnh v·ªã, t·ªça l·∫°c",
                example: "The temple is located on the top of the mountain.",
                exampleVi: "Ng√¥i ch√πa t·ªça l·∫°c tr√™n ƒë·ªânh n√∫i."
            },
            {
                word: "peaceful",
                ipa: "/ÀàpiÀêsf…ôl/",
                type: "(adjective)",
                meaning: "y√™n b√¨nh, h√≤a b√¨nh",
                example: "The countryside is very peaceful and quiet.",
                exampleVi: "V√πng n√¥ng th√¥n r·∫•t y√™n b√¨nh v√† tƒ©nh l·∫∑ng."
            },
            {
                word: "political",
                ipa: "/p…ôÀàl…™t…™k…ôl/",
                type: "(adjective)",
                meaning: "thu·ªôc v·ªÅ ch√≠nh tr·ªã",
                example: "Ho Chi Minh was a great political leader.",
                exampleVi: "H·ªì Ch√≠ Minh l√† m·ªôt nh√† l√£nh ƒë·∫°o ch√≠nh tr·ªã vƒ© ƒë·∫°i."
            },
            {
                word: "pond",
                ipa: "/p…ëÀênd/",
                type: "(noun)",
                meaning: "ao",
                example: "There is a lotus pond in the temple garden.",
                exampleVi: "C√≥ m·ªôt ao sen trong v∆∞·ªùn ch√πa."
            },
            {
                word: "popular",
                ipa: "/Ààp…ëÀêpj…ôl…ôr/",
                type: "(adjective)",
                meaning: "ph·ªï bi·∫øn, n·ªïi ti·∫øng",
                example: "Pho is a popular Vietnamese dish.",
                exampleVi: "Ph·ªü l√† m·ªôt m√≥n ƒÉn ph·ªï bi·∫øn c·ªßa Vi·ªát Nam."
            },
            {
                word: "ready",
                ipa: "/Ààredi/",
                type: "(adjective)",
                meaning: "s·∫µn s√†ng",
                example: "Are you ready to visit the museum?",
                exampleVi: "B·∫°n ƒë√£ s·∫µn s√†ng thƒÉm b·∫£o t√†ng ch∆∞a?"
            },
            {
                word: "temple",
                ipa: "/Ààtemp…ôl/",
                type: "(noun)",
                meaning: "ƒë·ªÅn, ch√πa",
                example: "The Temple of Literature is Vietnam's first university.",
                exampleVi: "VƒÉn Mi·∫øu l√† tr∆∞·ªùng ƒë·∫°i h·ªçc ƒë·∫ßu ti√™n c·ªßa Vi·ªát Nam."
            }
        ];

        // Vocabulary quiz questions
        const vocabQuizQuestions = vocabularyData.map((vocab, index) => ({
            question: `What does "${vocab.word}" mean?`,
            options: [
                vocab.meaning,
                // Generate 3 random wrong answers from other vocabulary
                vocabularyData[(index + 10) % vocabularyData.length].meaning,
                vocabularyData[(index + 20) % vocabularyData.length].meaning,
                vocabularyData[(index + 30) % vocabularyData.length].meaning
            ].sort(() => Math.random() - 0.5), // Shuffle options
            correct: 0, // Will be recalculated after shuffle
            word: vocab.word,
            correctMeaning: vocab.meaning
        })).map(q => {
            // Find correct answer index after shuffle
            q.correct = q.options.indexOf(q.correctMeaning);
            return q;
        });

        // ASEAN Countries data
        const aseanCountries = [
            {
                name: "Brunei",
                nameVi: "Brunei",
                capital: "Bandar Seri Begawan",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="40" fill="#FCD116"/><rect width="60" height="20" fill="#000000"/><rect y="20" width="60" height="20" fill="#FFFFFF"/><circle cx="30" cy="20" r="8" fill="#CE1126" stroke="#000" stroke-width="1"/></svg>`,
                hello: "Selamat pagi",
                helloMeaning: "Ch√†o bu·ªïi s√°ng",
                joinedYear: 1984,
                description: "Brunei l√† m·ªôt qu·ªëc gia nh·ªè gi√†u c√≥ nh·ªù d·∫ßu m·ªè, n·ªïi ti·∫øng v·ªõi ki·∫øn tr√∫c H·ªìi gi√°o tuy·ªát ƒë·∫πp."
            },
            {
                name: "Cambodia",
                nameVi: "Campuchia", 
                capital: "Phnom Penh",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="13" fill="#032EA1"/><rect y="13" width="60" height="14" fill="#E70011"/><rect y="27" width="60" height="13" fill="#032EA1"/><rect x="20" y="16" width="20" height="8" fill="#FFFFFF" rx="1"/></svg>`,
                hello: "Chum reap suor",
                helloMeaning: "Xin ch√†o",
                joinedYear: 1999,
                description: "Campuchia n·ªïi ti·∫øng v·ªõi qu·∫ßn th·ªÉ ƒë·ªÅn Angkor Wat - k·ª≥ quan th·∫ø gi·ªõi v√† di s·∫£n vƒÉn h√≥a Khmer c·ªï ƒë·∫°i."
            },
            {
                name: "Indonesia",
                nameVi: "Indonesia",
                capital: "Jakarta", 
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="20" fill="#FF0000"/><rect y="20" width="60" height="20" fill="#FFFFFF"/></svg>`,
                hello: "Selamat pagi",
                helloMeaning: "Ch√†o bu·ªïi s√°ng",
                joinedYear: 1967,
                description: "Indonesia l√† qu·ªëc gia qu·∫ßn ƒë·∫£o l·ªõn nh·∫•t th·∫ø gi·ªõi v·ªõi h∆°n 17.000 ƒë·∫£o v√† vƒÉn h√≥a ƒëa d·∫°ng."
            },
            {
                name: "Laos",
                nameVi: "L√†o",
                capital: "Vientiane",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="13" fill="#CE1126"/><rect y="13" width="60" height="14" fill="#002868"/><rect y="27" width="60" height="13" fill="#CE1126"/><circle cx="30" cy="20" r="6" fill="#FFFFFF"/></svg>`, 
                hello: "Sabaidee",
                helloMeaning: "Xin ch√†o",
                joinedYear: 1997,
                description: "L√†o l√† ƒë·∫•t n∆∞·ªõc kh√¥ng gi√°p bi·ªÉn v·ªõi thi√™n nhi√™n t∆∞∆°i ƒë·∫πp v√† vƒÉn h√≥a Ph·∫≠t gi√°o truy·ªÅn th·ªëng."
            },
            {
                name: "Malaysia",
                nameVi: "Malaysia",
                capital: "Kuala Lumpur",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="40" fill="#FFFFFF"/><rect width="60" height="3" fill="#CC0000"/><rect y="6" width="60" height="3" fill="#CC0000"/><rect y="12" width="60" height="3" fill="#CC0000"/><rect y="18" width="60" height="3" fill="#CC0000"/><rect y="24" width="60" height="3" fill="#CC0000"/><rect y="30" width="60" height="3" fill="#CC0000"/><rect y="36" width="60" height="4" fill="#CC0000"/><rect width="24" height="21" fill="#002868"/><path d="M12 10.5 L16 8 L20 10.5 L18 6 L22 4 L17 4 L15 0 L13 4 L8 4 L12 6 Z" fill="#FFCC00"/><circle cx="18" cy="12" r="4" fill="none" stroke="#FFCC00" stroke-width="1"/></svg>`,
                hello: "Selamat pagi", 
                helloMeaning: "Ch√†o bu·ªïi s√°ng",
                joinedYear: 1967,
                description: "Malaysia l√† qu·ªëc gia ƒëa vƒÉn h√≥a v·ªõi ki·∫øn tr√∫c hi·ªán ƒë·∫°i nh∆∞ th√°p ƒë√¥i Petronas v√† ·∫©m th·ª±c phong ph√∫."
            },
            {
                name: "Myanmar",
                nameVi: "Myanmar",
                capital: "Naypyidaw",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="13" fill="#FFCD00"/><rect y="13" width="60" height="14" fill="#34B233"/><rect y="27" width="60" height="13" fill="#EA2839"/><path d="M30 8 L32 14 L38 14 L33 18 L35 24 L30 20 L25 24 L27 18 L22 14 L28 14 Z" fill="#FFFFFF"/></svg>`,
                hello: "Mingalaba",
                helloMeaning: "Xin ch√†o",
                joinedYear: 1997,
                description: "Myanmar c√≥ h√†ng ngh√¨n ng√¥i ch√πa c·ªï ·ªü Bagan v√† l√† c√°i n√¥i c·ªßa vƒÉn h√≥a Ph·∫≠t gi√°o Theravada."
            },
            {
                name: "Philippines",
                nameVi: "Philippines", 
                capital: "Manila",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="20" fill="#0038A8"/><rect y="20" width="60" height="20" fill="#CE1126"/><polygon points="0,0 24,20 0,40" fill="#FFFFFF"/><circle cx="12" cy="12" r="3" fill="#FFCD00"/><path d="M12 8 L13 11 L16 11 L14 13 L15 16 L12 14 L9 16 L10 13 L8 11 L11 11 Z" fill="#0038A8"/><path d="M6 18 L10 20 L14 18 L18 20 L22 18" stroke="#FFCD00" stroke-width="1" fill="none"/></svg>`,
                hello: "Kumusta",
                helloMeaning: "Xin ch√†o",
                joinedYear: 1967,
                description: "Philippines g·ªìm h∆°n 7.000 ƒë·∫£o v·ªõi b√£i bi·ªÉn tuy·ªát ƒë·∫πp v√† l√† qu·ªëc gia n√≥i ti·∫øng Anh nhi·ªÅu nh·∫•t ƒê√¥ng Nam √Å."
            },
            {
                name: "Singapore",
                nameVi: "Singapore",
                capital: "Singapore",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="20" fill="#ED2939"/><rect y="20" width="60" height="20" fill="#FFFFFF"/><circle cx="15" cy="10" r="4" fill="#FFFFFF"/><path d="M8 6 L9 9 L12 9 L10 11 L11 14 L8 12 L5 14 L6 11 L4 9 L7 9 Z" fill="#ED2939"/><path d="M12 6 L13 9 L16 9 L14 11 L15 14 L12 12 L9 14 L10 11 L8 9 L11 9 Z" fill="#ED2939"/><path d="M16 6 L17 9 L20 9 L18 11 L19 14 L16 12 L13 14 L14 11 L12 9 L15 9 Z" fill="#ED2939"/><path d="M20 6 L21 9 L24 9 L22 11 L23 14 L20 12 L17 14 L18 11 L16 9 L19 9 Z" fill="#ED2939"/><path d="M24 6 L25 9 L28 9 L26 11 L27 14 L24 12 L21 14 L22 11 L20 9 L23 9 Z" fill="#ED2939"/></svg>`, 
                hello: "Hello",
                helloMeaning: "Xin ch√†o",
                joinedYear: 1967,
                description: "Singapore l√† th√†nh ph·ªë qu·ªëc gia hi·ªán ƒë·∫°i, trung t√¢m t√†i ch√≠nh v√† th∆∞∆°ng m·∫°i quan tr·ªçng c·ªßa khu v·ª±c."
            },
            {
                name: "Thailand",
                nameVi: "Th√°i Lan",
                capital: "Bangkok",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="6" fill="#ED1C24"/><rect y="6" width="60" height="6" fill="#FFFFFF"/><rect y="12" width="60" height="16" fill="#241D4F"/><rect y="28" width="60" height="6" fill="#FFFFFF"/><rect y="34" width="60" height="6" fill="#ED1C24"/></svg>`,
                hello: "Sawasdee krap/ka",
                helloMeaning: "Xin ch√†o",
                joinedYear: 1967,
                description: "Th√°i Lan n·ªïi ti·∫øng v·ªõi vƒÉn h√≥a Ph·∫≠t gi√°o, ·∫©m th·ª±c cay n·ªìng v√† l√† ƒëi·ªÉm ƒë·∫øn du l·ªãch h√†ng ƒë·∫ßu th·∫ø gi·ªõi."
            },
            {
                name: "Vietnam",
                nameVi: "Vi·ªát Nam",
                capital: "Hanoi",
                flagSvg: `<svg width="60" height="40" viewBox="0 0 60 40"><rect width="60" height="40" fill="#DA020E"/><path d="M30 8 L32 14 L38 14 L33 18 L35 24 L30 20 L25 24 L27 18 L22 14 L28 14 Z" fill="#FFFF00"/></svg>`,
                hello: "Xin ch√†o",
                helloMeaning: "Xin ch√†o", 
                joinedYear: 1995,
                description: "Vi·ªát Nam c√≥ l·ªãch s·ª≠ l√¢u ƒë·ªùi, vƒÉn h√≥a ƒë·ªôc ƒë√°o v√† c·∫£nh quan thi√™n nhi√™n ƒëa d·∫°ng t·ª´ n√∫i cao ƒë·∫øn bi·ªÉn xanh."
            }
        ];

        // Reading quiz questions
        const readingQuestions = [
            {
                question: "What makes Ha Long Bay special according to the passage?",
                options: ["It has sand dunes", "It has limestone islands and is a UNESCO World Heritage site", "It has ancient temples", "It has food stalls"],
                correct: 1,
                explanation: "Ha Long Bay, with its limestone islands, is another UNESCO World Heritage site that attracts millions of visitors."
            },
            {
                question: "What should visitors do before entering religious sites in Vietnam?",
                options: ["Bring offerings", "Take off their shoes", "Speak quietly", "Take photos"],
                correct: 1,
                explanation: "Visitors should take off their shoes before entering religious sites to show respect."
            },
            {
                question: "Which historical site showcases Vietnam's royal architecture?",
                options: ["Ha Long Bay", "Mui Ne sand dunes", "Hue's Imperial Citadel", "Sapa valleys"],
                correct: 2,
                explanation: "Hue's Imperial Citadel showcases Vietnam's royal architecture."
            },
            {
                question: "What do tour guides often do for visitors?",
                options: ["Sell souvenirs", "Explain wisdom behind traditions and recommend attractions", "Take photographs", "Prepare food"],
                correct: 1,
                explanation: "Tour guides often explain the wisdom behind ancient traditions and recommend must-visit tourist attractions."
            },
            {
                question: "According to the passage, what does Vietnam continue to do with its heritage?",
                options: ["Sell it to tourists", "Ignore it completely", "Conserve it while welcoming travelers", "Change it for modern times"],
                correct: 2,
                explanation: "The country continues to conserve its heritage while welcoming travelers to experience its popular destinations."
            }
        ];

        // Grammar topics content
        const grammarTopics = {
            'past-continuous': {
                title: 'Past Continuous Tense',
                content: `
                    <h3 class="text-xl font-bold mb-4">Past Continuous Tense (Th√¨ qu√° kh·ª© ti·∫øp di·ªÖn)</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">1. C·∫•u tr√∫c:</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>Kh·∫≥ng ƒë·ªãnh:</strong> S + was/were + V-ing</p>
                            <p><strong>Ph·ªß ƒë·ªãnh:</strong> S + was/were + not + V-ing</p>
                            <p><strong>Nghi v·∫•n:</strong> Was/Were + S + V-ing?</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">2. C√°ch s·ª≠ d·ª•ng:</h4>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Di·ªÖn t·∫£ h√†nh ƒë·ªông ƒëang x·∫£y ra t·∫°i m·ªôt th·ªùi ƒëi·ªÉm c·ª• th·ªÉ trong qu√° kh·ª©</li>
                            <li>Di·ªÖn t·∫£ h√†nh ƒë·ªông ƒëang x·∫£y ra th√¨ c√≥ h√†nh ƒë·ªông kh√°c xen v√†o</li>
                            <li>Di·ªÖn t·∫£ hai h√†nh ƒë·ªông ƒëang x·∫£y ra song song trong qu√° kh·ª©</li>
                        </ul>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">3. V√≠ d·ª•:</h4>
                        <div class="bg-gray-50 p-4 rounded">
                            <p>‚Ä¢ I <strong>was studying</strong> at 8 PM yesterday.</p>
                            <p>‚Ä¢ While she <strong>was cooking</strong>, he <strong>was watching</strong> TV.</p>
                            <p>‚Ä¢ They <strong>were discussing</strong> ASEAN cooperation when I arrived.</p>
                        </div>
                    </div>
                `
            },
            'cleft-sentence': {
                title: 'Cleft Sentences',
                content: `
                    <h3 class="text-xl font-bold mb-4">Cleft Sentences (C√¢u ch·∫ª)</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">1. C·∫•u tr√∫c It-cleft:</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>It + is/was + focused element + that/who + rest of sentence</strong></p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">2. C√°ch s·ª≠ d·ª•ng:</h4>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Nh·∫•n m·∫°nh m·ªôt th√†nh ph·∫ßn c·ª• th·ªÉ trong c√¢u</li>
                            <li>D√πng "who" khi nh·∫•n m·∫°nh ng∆∞·ªùi</li>
                            <li>D√πng "that" khi nh·∫•n m·∫°nh v·∫≠t ho·∫∑c s·ª± vi·ªác</li>
                        </ul>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">3. V√≠ d·ª•:</h4>
                        <div class="bg-gray-50 p-4 rounded">
                            <p>‚Ä¢ <strong>It was Vietnam</strong> that joined ASEAN in 1995.</p>
                            <p>‚Ä¢ <strong>It is cooperation</strong> that strengthens regional bonds.</p>
                            <p>‚Ä¢ <strong>It was the president</strong> who signed the agreement.</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">4. What-cleft:</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>What + S + V + is/was + focused element</strong></p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ <strong>What Vietnam needs</strong> is more international cooperation.</p>
                            <p>‚Ä¢ <strong>What ASEAN promotes</strong> is regional integration.</p>
                        </div>
                    </div>
                `
            },
            'articles': {
                title: 'Articles (a/an/the)',
                content: `
                    <h3 class="text-xl font-bold mb-4">Articles - M·∫°o t·ª´ (a/an/the)</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">1. M·∫°o t·ª´ kh√¥ng x√°c ƒë·ªãnh (a/an):</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>a:</strong> tr∆∞·ªõc ph·ª• √¢m</p>
                            <p><strong>an:</strong> tr∆∞·ªõc nguy√™n √¢m (a, e, i, o, u)</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ <strong>a</strong> country, <strong>a</strong> university</p>
                            <p>‚Ä¢ <strong>an</strong> association, <strong>an</strong> organization</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">2. M·∫°o t·ª´ x√°c ƒë·ªãnh (the):</h4>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Tr∆∞·ªõc danh t·ª´ ƒë√£ ƒë∆∞·ª£c x√°c ƒë·ªãnh c·ª• th·ªÉ</li>
                            <li>Tr∆∞·ªõc danh t·ª´ duy nh·∫•t</li>
                            <li>Tr∆∞·ªõc t√™n t·ªï ch·ª©c, hi·ªáp h·ªôi</li>
                            <li>Tr∆∞·ªõc so s√°nh nh·∫•t</li>
                        </ul>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ <strong>The</strong> ASEAN summit</p>
                            <p>‚Ä¢ <strong>The</strong> most important issue</p>
                            <p>‚Ä¢ <strong>The</strong> United Nations</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">3. Kh√¥ng d√πng m·∫°o t·ª´:</h4>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Tr∆∞·ªõc danh t·ª´ s·ªë nhi·ªÅu chung chung</li>
                            <li>Tr∆∞·ªõc danh t·ª´ kh√¥ng ƒë·∫øm ƒë∆∞·ª£c chung chung</li>
                            <li>Tr∆∞·ªõc t√™n n∆∞·ªõc (tr·ª´ m·ªôt s·ªë tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát)</li>
                        </ul>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ Countries in Southeast Asia</p>
                            <p>‚Ä¢ Vietnam and Thailand</p>
                            <p>‚Ä¢ Economic cooperation</p>
                        </div>
                    </div>
                `
            },
            'its-time': {
                title: "It's time",
                content: `
                    <h3 class="text-xl font-bold mb-4">C·∫•u tr√∫c "It's time"</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">1. It's time + to V:</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>It's time + to + infinitive</strong></p>
                            <p>Nghƒ©a: ƒê√£ ƒë·∫øn l√∫c l√†m g√¨ ƒë√≥</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ It's time <strong>to start</strong> the meeting.</p>
                            <p>‚Ä¢ It's time <strong>to strengthen</strong> regional cooperation.</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">2. It's time + S + V (past tense):</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>It's time + S + V (qu√° kh·ª© ƒë∆°n)</strong></p>
                            <p>Nghƒ©a: ƒê√£ ƒë·∫øn l√∫c ai ƒë√≥ n√™n l√†m g√¨ (mang t√≠nh khuy√™n b·∫£o)</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ It's time we <strong>worked</strong> together more closely.</p>
                            <p>‚Ä¢ It's time ASEAN <strong>addressed</strong> climate change.</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">3. It's high time:</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>It's high time + S + V (past tense)</strong></p>
                            <p>Nghƒ©a: ƒê√£ qu√° mu·ªôn, c·∫ßn ph·∫£i l√†m ngay</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ It's high time we <strong>took</strong> action on this issue.</p>
                            <p>‚Ä¢ It's high time the government <strong>implemented</strong> new policies.</p>
                        </div>
                    </div>
                `
            },
            'would-rather': {
                title: 'Would rather',
                content: `
                    <h3 class="text-xl font-bold mb-4">C·∫•u tr√∫c "Would rather"</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">1. Would rather + V (bare infinitive):</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>S + would rather + V (nguy√™n m·∫´u kh√¥ng to)</strong></p>
                            <p>Nghƒ©a: Th√≠ch l√†m g√¨ h∆°n</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ I would rather <strong>stay</strong> home tonight.</p>
                            <p>‚Ä¢ She'd rather <strong>work</strong> in a team.</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">2. Would rather + V + than + V:</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>S + would rather + V + than + V</strong></p>
                            <p>Nghƒ©a: Th√≠ch l√†m g√¨ h∆°n l√† l√†m g√¨</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ I'd rather <strong>study</strong> English than <strong>watch</strong> TV.</p>
                            <p>‚Ä¢ They'd rather <strong>cooperate</strong> than <strong>compete</strong>.</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">3. Would rather + S + V (past tense):</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>S + would rather + S + V (qu√° kh·ª© ƒë∆°n)</strong></p>
                            <p>Nghƒ©a: Mu·ªën ai ƒë√≥ l√†m g√¨</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ I'd rather you <strong>came</strong> early.</p>
                            <p>‚Ä¢ We'd rather the meeting <strong>started</strong> on time.</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">4. Would rather not:</h4>
                        <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                            <p><strong>S + would rather not + V</strong></p>
                            <p>Nghƒ©a: Kh√¥ng mu·ªën l√†m g√¨</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded mt-2">
                            <p>‚Ä¢ I'd rather not <strong>discuss</strong> this now.</p>
                            <p>‚Ä¢ She'd rather not <strong>attend</strong> the conference.</p>
                        </div>
                    </div>
                `
            }
        };

        // Comprehensive test questions
        const comprehensiveTest = [
            {
                question: "Vietnam _____ ASEAN in 1995.",
                options: ["joined", "was joining", "has joined", "had joined"],
                correct: 0,
                topic: "Past Simple"
            },
            {
                question: "While the delegates _____ the agreement, the media _____ outside.",
                options: ["signed / waited", "were signing / were waiting", "signed / were waiting", "were signing / waited"],
                correct: 1,
                topic: "Past Continuous"
            },
            {
                question: "It _____ cooperation that strengthens regional bonds.",
                options: ["was", "is", "were", "are"],
                correct: 1,
                topic: "Cleft Sentences"
            },
            {
                question: "ASEAN is _____ association of Southeast Asian nations.",
                options: ["a", "an", "the", "no article"],
                correct: 1,
                topic: "Articles"
            },
            {
                question: "It's time we _____ more closely together.",
                options: ["work", "worked", "working", "to work"],
                correct: 1,
                topic: "It's time"
            },
            {
                question: "I'd rather _____ in a multicultural environment.",
                options: ["to work", "working", "work", "worked"],
                correct: 2,
                topic: "Would rather"
            },
            {
                question: "_____ president who signed the historic agreement.",
                options: ["It was the", "It is the", "The", "A"],
                correct: 0,
                topic: "Cleft Sentences"
            },
            {
                question: "At 9 AM yesterday, the ministers _____ about trade policies.",
                options: ["discussed", "were discussing", "had discussed", "discuss"],
                correct: 1,
                topic: "Past Continuous"
            },
            {
                question: "Vietnam has become _____ important member of ASEAN.",
                options: ["a", "an", "the", "no article"],
                correct: 1,
                topic: "Articles"
            },
            {
                question: "It's high time ASEAN _____ climate change seriously.",
                options: ["takes", "took", "taking", "to take"],
                correct: 1,
                topic: "It's time"
            },
            {
                question: "She'd rather _____ English than French.",
                options: ["study", "studying", "to study", "studied"],
                correct: 0,
                topic: "Would rather"
            },
            {
                question: "What ASEAN needs _____ stronger economic integration.",
                options: ["are", "is", "were", "was"],
                correct: 1,
                topic: "Cleft Sentences"
            },
            {
                question: "While I _____ the report, my colleague _____ the presentation.",
                options: ["wrote / prepared", "was writing / was preparing", "wrote / was preparing", "was writing / prepared"],
                correct: 1,
                topic: "Past Continuous"
            },
            {
                question: "_____ United Nations supports ASEAN initiatives.",
                options: ["A", "An", "The", "No article"],
                correct: 2,
                topic: "Articles"
            },
            {
                question: "It's time _____ a new approach to regional cooperation.",
                options: ["adopt", "to adopt", "adopting", "adopted"],
                correct: 1,
                topic: "It's time"
            },
            {
                question: "I'd rather you _____ the meeting tomorrow.",
                options: ["attend", "attended", "attending", "to attend"],
                correct: 1,
                topic: "Would rather"
            },
            {
                question: "It _____ in 1995 that Vietnam joined ASEAN.",
                options: ["is", "was", "were", "are"],
                correct: 1,
                topic: "Cleft Sentences"
            },
            {
                question: "The delegates _____ when the announcement was made.",
                options: ["were discussing", "discussed", "had discussed", "discuss"],
                correct: 0,
                topic: "Past Continuous"
            },
            {
                question: "Economic cooperation requires _____ commitment from all members.",
                options: ["a", "an", "the", "no article"],
                correct: 0,
                topic: "Articles"
            },
            {
                question: "It's time the government _____ new policies.",
                options: ["implements", "implemented", "implementing", "to implement"],
                correct: 1,
                topic: "It's time"
            },
            {
                question: "They'd rather _____ than compete.",
                options: ["cooperate", "cooperating", "to cooperate", "cooperated"],
                correct: 0,
                topic: "Would rather"
            },
            {
                question: "_____ Vietnam that has shown remarkable economic growth.",
                options: ["It is", "It was", "There is", "There was"],
                correct: 0,
                topic: "Cleft Sentences"
            },
            {
                question: "At this time last year, ASEAN _____ its 50th anniversary.",
                options: ["celebrated", "was celebrating", "celebrates", "had celebrated"],
                correct: 1,
                topic: "Past Continuous"
            },
            {
                question: "_____ cooperation between nations is essential for peace.",
                options: ["A", "An", "The", "No article"],
                correct: 3,
                topic: "Articles"
            },
            {
                question: "It's high time we _____ about environmental protection.",
                options: ["think", "thought", "thinking", "to think"],
                correct: 1,
                topic: "It's time"
            },
            {
                question: "I'd rather not _____ this issue right now.",
                options: ["discuss", "discussing", "to discuss", "discussed"],
                correct: 0,
                topic: "Would rather"
            },
            {
                question: "What the region needs _____ sustainable development.",
                options: ["are", "is", "were", "was"],
                correct: 1,
                topic: "Cleft Sentences"
            },
            {
                question: "While the summit _____ place, protesters _____ outside.",
                options: ["took / gathered", "was taking / were gathering", "took / were gathering", "was taking / gathered"],
                correct: 2,
                topic: "Past Continuous"
            },
            {
                question: "ASEAN promotes _____ peace and stability in the region.",
                options: ["a", "an", "the", "no article"],
                correct: 3,
                topic: "Articles"
            },
            {
                question: "It's time _____ our differences and work together.",
                options: ["forget", "to forget", "forgetting", "forgot"],
                correct: 1,
                topic: "It's time"
            }
        ];

        // Audio context for sound effects
        let audioContext;
        let isFlipped = false;
        let currentVocabIndex = 0;
        let currentReadingQuestion = 0;
        let readingScore = 0;
        let currentGrammarTest = 0;
        let grammarTestScore = 0;
        let currentVocabQuiz = 0;
        let vocabQuizScore = 0;
        let activeTab = 'vocab';
        let vocabMode = 'flashcard'; // 'flashcard' or 'quiz'
        let readingMode = 'reading'; // 'reading' or 'asean'

        // Initialize audio context
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        // Play sound effect
        function playSound(frequency, duration, type = 'correct') {
            initAudio();
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (type === 'correct') {
                // Happy sound - ascending notes
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(frequency * 1.5, audioContext.currentTime + duration / 2);
                oscillator.frequency.exponentialRampToValueAtTime(frequency * 2, audioContext.currentTime + duration);
            } else {
                // Error sound - descending notes
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(frequency * 0.7, audioContext.currentTime + duration / 2);
                oscillator.frequency.exponentialRampToValueAtTime(frequency * 0.5, audioContext.currentTime + duration);
            }
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        // Text-to-speech for vocabulary
        function speakWord(word) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            }
        }

        // Text-to-speech for ASEAN greetings
        function speakGreeting(greeting, language = 'en-US') {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(greeting);
                utterance.lang = language;
                utterance.rate = 0.7;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            }
        }

        // Switch reading mode
        function switchReadingMode(mode) {
            readingMode = mode;
            
            // Update button styles
            const readingBtn = document.getElementById('reading-mode');
            const aseanBtn = document.getElementById('asean-mode');
            
            if (mode === 'reading') {
                readingBtn.classList.add('bg-blue-500');
                readingBtn.classList.remove('bg-gray-400');
                aseanBtn.classList.add('bg-gray-400');
                aseanBtn.classList.remove('bg-orange-500');
                
                document.getElementById('reading-container').classList.remove('hidden');
                document.getElementById('asean-container').classList.add('hidden');
            } else {
                readingBtn.classList.add('bg-gray-400');
                readingBtn.classList.remove('bg-blue-500');
                aseanBtn.classList.add('bg-orange-500');
                aseanBtn.classList.remove('bg-gray-400');
                
                document.getElementById('reading-container').classList.add('hidden');
                document.getElementById('asean-container').classList.remove('hidden');
                
                // Load ASEAN countries if not loaded
                if (document.getElementById('asean-countries').children.length === 0) {
                    loadAseanCountries();
                }
            }
        }

        // Load ASEAN countries
        function loadAseanCountries() {
            const container = document.getElementById('asean-countries');
            container.innerHTML = '';
            
            aseanCountries.forEach(country => {
                const countryCard = document.createElement('div');
                countryCard.className = 'bg-white rounded-lg p-3 sm:p-4 shadow-md hover:shadow-lg transition-shadow border border-orange-200';
                countryCard.innerHTML = `
                    <div class="text-center mb-3">
                        <div class="mb-2 flex justify-center">${country.flagSvg}</div>
                        <h4 class="font-bold text-sm sm:text-base text-orange-800">${country.nameVi}</h4>
                        <p class="text-xs text-gray-600">${country.name}</p>
                    </div>
                    
                    <div class="space-y-1 text-xs">
                        <div><strong>Th·ªß ƒë√¥:</strong> ${country.capital}</div>
                        <div><strong>Gia nh·∫≠p ASEAN:</strong> ${country.joinedYear}</div>
                    </div>
                    
                    <div class="mt-2 p-2 bg-orange-50 rounded-lg">
                        <div class="flex items-center justify-between mb-1">
                            <div class="flex-1 min-w-0">
                                <div class="font-semibold text-orange-800 text-xs truncate">"${country.hello}"</div>
                                <div class="text-xs text-gray-600">${country.helloMeaning}</div>
                            </div>
                            <button class="greeting-btn bg-orange-500 hover:bg-orange-600 text-white p-1.5 rounded-full transition-colors ml-2 flex-shrink-0" 
                                    data-greeting="${country.hello}" data-country="${country.name}">
                                üîä
                            </button>
                        </div>
                    </div>
                    
                    <div class="mt-2 text-xs text-gray-700 leading-relaxed">
                        ${country.description}
                    </div>
                `;
                
                container.appendChild(countryCard);
            });

            // Add event listeners for greeting buttons
            document.querySelectorAll('.greeting-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const greeting = e.target.dataset.greeting;
                    const country = e.target.dataset.country;
                    
                    // Determine language code for better pronunciation
                    let langCode = 'en-US';
                    if (country === 'Vietnam') langCode = 'vi-VN';
                    else if (country === 'Thailand') langCode = 'th-TH';
                    else if (country === 'Indonesia' || country === 'Malaysia' || country === 'Brunei') langCode = 'id-ID';
                    else if (country === 'Philippines') langCode = 'en-PH';
                    else if (country === 'Cambodia') langCode = 'km-KH';
                    else if (country === 'Laos') langCode = 'lo-LA';
                    else if (country === 'Myanmar') langCode = 'my-MM';
                    
                    speakGreeting(greeting, langCode);
                    
                    // Visual feedback
                    e.target.style.transform = 'scale(0.9)';
                    setTimeout(() => {
                        e.target.style.transform = 'scale(1)';
                    }, 150);
                });
            });
        }

        // Data SDK implementation
        const dataHandler = {
            onDataChanged(data) {
                if (data.length > 0) {
                    currentData = data[0];
                    currentVocabIndex = currentData.current_vocab_index || 0;
                    updateProgress();
                    updateVocabularyDisplay();
                } else {
                    // Initialize with default data
                    currentData = {
                        vocabulary_progress: 0,
                        reading_progress: 0,
                        grammar_progress: 0,
                        current_vocab_index: 0,
                        completed_reading: false,
                        completed_grammar_topics: '',
                        quiz_scores: ''
                    };
                    updateProgress();
                    updateVocabularyDisplay();
                }
            }
        };

        // Element SDK implementation
        async function onConfigChange(config) {
            const unitTitle = document.getElementById('unit-title');
            const welcomeMessage = document.getElementById('welcome-message');
            const homeButtonText = document.getElementById('home-button-text');

            if (unitTitle) unitTitle.textContent = config.unit_title || defaultConfig.unit_title;
            if (welcomeMessage) welcomeMessage.textContent = config.welcome_message || defaultConfig.welcome_message;
            if (homeButtonText) homeButtonText.textContent = config.home_button_text || defaultConfig.home_button_text;

            // Apply colors
            document.body.style.background = `linear-gradient(to bottom right, ${config.background_color || defaultConfig.background_color}, ${config.primary_color || defaultConfig.primary_color}33)`;
            
            const surfaces = document.querySelectorAll('header, main, .bg-white');
            surfaces.forEach(surface => {
                surface.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
            });

            const textElements = document.querySelectorAll('h1, h2, h3, p, span, div');
            textElements.forEach(element => {
                if (!element.classList.contains('text-white')) {
                    element.style.color = config.text_color || defaultConfig.text_color;
                }
            });
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.background_color || defaultConfig.background_color,
                        set: (value) => {
                            config.background_color = value;
                            window.elementSdk.setConfig({ background_color: value });
                        }
                    },
                    {
                        get: () => config.surface_color || defaultConfig.surface_color,
                        set: (value) => {
                            config.surface_color = value;
                            window.elementSdk.setConfig({ surface_color: value });
                        }
                    },
                    {
                        get: () => config.text_color || defaultConfig.text_color,
                        set: (value) => {
                            config.text_color = value;
                            window.elementSdk.setConfig({ text_color: value });
                        }
                    },
                    {
                        get: () => config.primary_color || defaultConfig.primary_color,
                        set: (value) => {
                            config.primary_color = value;
                            window.elementSdk.setConfig({ primary_color: value });
                        }
                    },
                    {
                        get: () => config.accent_color || defaultConfig.accent_color,
                        set: (value) => {
                            config.accent_color = value;
                            window.elementSdk.setConfig({ accent_color: value });
                        }
                    }
                ],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["unit_title", config.unit_title || defaultConfig.unit_title],
                ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
                ["home_button_text", config.home_button_text || defaultConfig.home_button_text]
            ]);
        }

        // Update progress display
        function updateProgress() {
            const vocabProgress = currentData.vocabulary_progress || 0;
            const readingProgress = currentData.completed_reading ? 100 : 0;
            const grammarTopicsCompleted = (currentData.completed_grammar_topics || '').split(',').filter(t => t).length;
            const grammarProgress = Math.round((grammarTopicsCompleted / 6) * 100); // 5 topics + 1 comprehensive test
            const totalProgress = Math.round((vocabProgress + readingProgress + grammarProgress) / 3);

            document.getElementById('total-progress').textContent = `${totalProgress}%`;
            document.getElementById('vocab-progress').textContent = `${vocabProgress}%`;
            document.getElementById('reading-progress').textContent = `${readingProgress}%`;
            document.getElementById('grammar-progress').textContent = `${grammarProgress}%`;

            document.getElementById('total-bar').style.width = `${totalProgress}%`;
            document.getElementById('vocab-bar').style.width = `${vocabProgress}%`;
            document.getElementById('reading-bar').style.width = `${readingProgress}%`;
            document.getElementById('grammar-bar').style.width = `${grammarProgress}%`;
        }

        // Update vocabulary display
        function updateVocabularyDisplay() {
            const vocab = vocabularyData[currentVocabIndex];
            if (vocab) {
                document.getElementById('vocab-word').textContent = vocab.word;
                document.getElementById('vocab-ipa').textContent = vocab.ipa;
                document.getElementById('vocab-type').textContent = vocab.type;
                document.getElementById('vocab-meaning').textContent = vocab.meaning;
                document.getElementById('vocab-example').textContent = vocab.example;
                document.getElementById('vocab-example-vi').textContent = vocab.exampleVi;
                document.getElementById('vocab-counter').textContent = `${currentVocabIndex + 1} / ${vocabularyData.length}`;
            }
        }

        // Switch vocabulary mode
        function switchVocabMode(mode) {
            vocabMode = mode;
            
            // Update button styles
            const flashcardBtn = document.getElementById('flashcard-mode');
            const quizBtn = document.getElementById('vocab-quiz-mode');
            
            if (mode === 'flashcard') {
                flashcardBtn.classList.add('bg-green-500');
                flashcardBtn.classList.remove('bg-gray-400');
                quizBtn.classList.add('bg-gray-400');
                quizBtn.classList.remove('bg-orange-500');
                
                document.getElementById('flashcard-container').classList.remove('hidden');
                document.getElementById('vocab-quiz-container').classList.add('hidden');
            } else {
                flashcardBtn.classList.add('bg-gray-400');
                flashcardBtn.classList.remove('bg-green-500');
                quizBtn.classList.add('bg-orange-500');
                quizBtn.classList.remove('bg-gray-400');
                
                document.getElementById('flashcard-container').classList.add('hidden');
                document.getElementById('vocab-quiz-container').classList.remove('hidden');
                
                // Load first quiz question
                loadVocabQuizQuestion();
            }
        }

        // Load vocabulary quiz question
        function loadVocabQuizQuestion() {
            const question = vocabQuizQuestions[currentVocabQuiz];
            const questionDiv = document.getElementById('vocab-quiz-question');
            
            questionDiv.innerHTML = `
                <h4 class="font-semibold mb-4">${currentVocabQuiz + 1}. ${question.question}</h4>
                <div class="text-sm text-gray-600 mb-4">Word: <strong>"${question.word}"</strong></div>
                <div class="space-y-2">
                    ${question.options.map((option, index) => `
                        <div class="quiz-option p-3 border rounded-lg cursor-pointer hover:bg-orange-50" 
                             data-option="${index}">
                            ${String.fromCharCode(65 + index)}. ${option}
                        </div>
                    `).join('')}
                </div>
            `;

            // Add event listeners
            questionDiv.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', handleVocabQuizAnswer);
            });

            // Update navigation
            document.getElementById('current-vocab-question').textContent = currentVocabQuiz + 1;
            document.getElementById('prev-vocab-question').disabled = currentVocabQuiz === 0;
            document.getElementById('next-vocab-question').disabled = currentVocabQuiz === vocabQuizQuestions.length - 1;
        }

        // Handle vocabulary quiz answer
        function handleVocabQuizAnswer(event) {
            const selectedOption = parseInt(event.target.dataset.option);
            const question = vocabQuizQuestions[currentVocabQuiz];
            const isCorrect = selectedOption === question.correct;
            
            // Disable all options
            const options = event.target.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (parseInt(opt.dataset.option) === question.correct) {
                    opt.classList.add('correct');
                } else if (opt === event.target && !isCorrect) {
                    opt.classList.add('incorrect');
                }
            });

            // Play sound and update score
            if (isCorrect) {
                playSound(659, 0.5, 'correct'); // E5 note
                vocabQuizScore++;
                document.getElementById('vocab-quiz-score').textContent = vocabQuizScore;
            } else {
                playSound(294, 0.5, 'incorrect'); // D4 note
            }
        }

        // Navigate vocabulary quiz
        function navigateVocabQuiz(direction) {
            const newIndex = Math.max(0, Math.min(vocabQuizQuestions.length - 1, currentVocabQuiz + direction));
            if (newIndex !== currentVocabQuiz) {
                currentVocabQuiz = newIndex;
                loadVocabQuizQuestion();
            }
        }

        // Flip flashcard
        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            flashcard.classList.toggle('flipped');
            isFlipped = !isFlipped;
        }

        // Navigate vocabulary
        async function navigateVocab(direction) {
            const newIndex = Math.max(0, Math.min(vocabularyData.length - 1, currentVocabIndex + direction));
            
            if (newIndex !== currentVocabIndex) {
                currentVocabIndex = newIndex;
                
                // Update display immediately
                updateVocabularyDisplay();
                
                // Reset flip state
                const flashcard = document.getElementById('flashcard');
                flashcard.classList.remove('flipped');
                isFlipped = false;
                
                // Speak the new word
                setTimeout(() => {
                    speakWord(vocabularyData[newIndex].word);
                }, 300);
                
                // Update progress based on highest index reached
                const vocabProgress = Math.round(((newIndex + 1) / vocabularyData.length) * 100);
                currentData.vocabulary_progress = Math.max(currentData.vocabulary_progress || 0, vocabProgress);
                currentData.current_vocab_index = newIndex;
                
                // Update progress display
                updateProgress();
                
                // Save progress in background
                if (window.dataSdk) {
                    window.dataSdk.update(currentData);
                }
            }
        }

        // Generate reading quiz
        function generateReadingQuiz() {
            const quizContainer = document.getElementById('reading-quiz');
            quizContainer.innerHTML = '';
            
            readingQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'mb-6 p-4 bg-white rounded-lg border';
                questionDiv.innerHTML = `
                    <h4 class="font-semibold mb-3">${index + 1}. ${q.question}</h4>
                    <div class="space-y-2">
                        ${q.options.map((option, optIndex) => `
                            <div class="quiz-option p-3 border rounded-lg cursor-pointer hover:bg-blue-50" 
                                 data-question="${index}" data-option="${optIndex}">
                                ${String.fromCharCode(65 + optIndex)}. ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation mt-3 text-sm text-gray-600 hidden"></div>
                `;
                quizContainer.appendChild(questionDiv);
            });

            // Add event listeners
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', handleReadingAnswer);
            });
        }

        // Handle reading quiz answer
        async function handleReadingAnswer(event) {
            const questionIndex = parseInt(event.target.dataset.question);
            const selectedOption = parseInt(event.target.dataset.option);
            const question = readingQuestions[questionIndex];
            const isCorrect = selectedOption === question.correct;
            
            // Disable all options for this question
            const questionDiv = event.target.closest('.mb-6');
            const options = questionDiv.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (parseInt(opt.dataset.option) === question.correct) {
                    opt.classList.add('correct');
                } else if (opt === event.target && !isCorrect) {
                    opt.classList.add('incorrect');
                }
            });

            // Show explanation
            const explanation = questionDiv.querySelector('.explanation');
            explanation.textContent = question.explanation;
            explanation.classList.remove('hidden');

            // Play sound
            if (isCorrect) {
                playSound(523, 0.5, 'correct'); // C5 note
                readingScore++;
            } else {
                playSound(330, 0.5, 'incorrect'); // E4 note
            }

            // Update score
            document.getElementById('reading-score').textContent = `ƒêi·ªÉm: ${readingScore}/5`;

            // Check if all questions answered
            const answeredQuestions = document.querySelectorAll('.quiz-option[style*="pointer-events: none"]').length / 4;
            if (answeredQuestions === readingQuestions.length) {
                currentData.completed_reading = true;
                currentData.reading_progress = 100;
                
                const result = await window.dataSdk.create(currentData);
                if (result.isOk) {
                    updateProgress();
                }
            }
        }

        // Show grammar topic
        function showGrammarTopic(topicKey) {
            const contentDiv = document.getElementById('grammar-content');
            
            if (topicKey === 'comprehensive-test') {
                showComprehensiveTest();
                return;
            }
            
            const topic = grammarTopics[topicKey];
            if (topic) {
                contentDiv.innerHTML = topic.content;
                contentDiv.classList.remove('hidden');
                contentDiv.classList.add('fade-in');
                
                // Mark topic as completed
                const completedTopics = currentData.completed_grammar_topics.split(',').filter(t => t);
                if (!completedTopics.includes(topicKey)) {
                    completedTopics.push(topicKey);
                    currentData.completed_grammar_topics = completedTopics.join(',');
                    window.dataSdk.create(currentData);
                    updateProgress();
                }
            }
        }

        // Show comprehensive test
        function showComprehensiveTest() {
            const contentDiv = document.getElementById('grammar-content');
            contentDiv.innerHTML = `
                <h3 class="text-xl font-bold mb-4 text-center">üéØ B√†i t·∫≠p t·ªïng h·ª£p - 30 c√¢u tr·∫Øc nghi·ªám</h3>
                <div class="mb-4 text-center">
                    <span class="text-sm text-gray-600">C√¢u <span id="current-question">1</span> / 30</span>
                    <div class="text-sm text-gray-600 mt-1">ƒêi·ªÉm: <span id="test-score">0</span>/30</div>
                </div>
                <div id="test-question" class="bg-white p-6 rounded-lg border">
                    <!-- Question will be loaded here -->
                </div>
                <div class="flex justify-between mt-4">
                    <button id="prev-question" class="bg-gray-500 text-white px-4 py-2 rounded-lg" disabled>‚Üê C√¢u tr∆∞·ªõc</button>
                    <button id="next-question" class="bg-blue-500 text-white px-4 py-2 rounded-lg">C√¢u ti·∫øp ‚Üí</button>
                </div>
            `;
            
            contentDiv.classList.remove('hidden');
            contentDiv.classList.add('fade-in');
            
            currentGrammarTest = 0;
            grammarTestScore = 0;
            loadGrammarTestQuestion();
            
            // Add event listeners
            document.getElementById('prev-question').addEventListener('click', () => navigateGrammarTest(-1));
            document.getElementById('next-question').addEventListener('click', () => navigateGrammarTest(1));
        }

        // Load grammar test question
        function loadGrammarTestQuestion() {
            const question = comprehensiveTest[currentGrammarTest];
            const questionDiv = document.getElementById('test-question');
            
            questionDiv.innerHTML = `
                <h4 class="font-semibold mb-4">${currentGrammarTest + 1}. ${question.question}</h4>
                <div class="space-y-2">
                    ${question.options.map((option, index) => `
                        <div class="quiz-option p-3 border rounded-lg cursor-pointer hover:bg-purple-50" 
                             data-option="${index}">
                            ${String.fromCharCode(65 + index)}. ${option}
                        </div>
                    `).join('')}
                </div>
                <div class="mt-3 text-xs text-gray-500">Ch·ªß ƒë·ªÅ: ${question.topic}</div>
            `;

            // Add event listeners
            questionDiv.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', handleGrammarTestAnswer);
            });

            // Update navigation
            document.getElementById('current-question').textContent = currentGrammarTest + 1;
            document.getElementById('prev-question').disabled = currentGrammarTest === 0;
            document.getElementById('next-question').disabled = currentGrammarTest === comprehensiveTest.length - 1;
        }

        // Handle grammar test answer
        async function handleGrammarTestAnswer(event) {
            const selectedOption = parseInt(event.target.dataset.option);
            const question = comprehensiveTest[currentGrammarTest];
            const isCorrect = selectedOption === question.correct;
            
            // Disable all options
            const options = event.target.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (parseInt(opt.dataset.option) === question.correct) {
                    opt.classList.add('correct');
                } else if (opt === event.target && !isCorrect) {
                    opt.classList.add('incorrect');
                }
            });

            // Play sound and update score
            if (isCorrect) {
                playSound(659, 0.5, 'correct'); // E5 note
                grammarTestScore++;
                document.getElementById('test-score').textContent = grammarTestScore;
            } else {
                playSound(294, 0.5, 'incorrect'); // D4 note
            }

            // Check if test completed
            if (currentGrammarTest === comprehensiveTest.length - 1) {
                const completedTopics = currentData.completed_grammar_topics.split(',').filter(t => t);
                if (!completedTopics.includes('comprehensive-test')) {
                    completedTopics.push('comprehensive-test');
                    currentData.completed_grammar_topics = completedTopics.join(',');
                    
                    const result = await window.dataSdk.create(currentData);
                    if (result.isOk) {
                        updateProgress();
                    }
                }
            }
        }

        // Navigate grammar test
        function navigateGrammarTest(direction) {
            const newIndex = Math.max(0, Math.min(comprehensiveTest.length - 1, currentGrammarTest + direction));
            if (newIndex !== currentGrammarTest) {
                currentGrammarTest = newIndex;
                loadGrammarTestQuestion();
            }
        }

        // Switch tabs
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('bg-gray-200', 'text-gray-700');
                btn.classList.remove('bg-green-500', 'bg-blue-500', 'bg-purple-500', 'text-white');
            });

            // Hide all sections
            document.querySelectorAll('#vocab-section, #reading-section, #grammar-section').forEach(section => {
                section.classList.add('hidden');
            });

            // Show selected section and update button
            if (tabName === 'vocab') {
                document.getElementById('vocab-section').classList.remove('hidden');
                document.getElementById('vocab-tab').classList.add('active', 'bg-green-500', 'text-white');
                document.getElementById('vocab-tab').classList.remove('bg-gray-200', 'text-gray-700');
            } else if (tabName === 'reading') {
                document.getElementById('reading-section').classList.remove('hidden');
                document.getElementById('reading-tab').classList.add('active', 'bg-blue-500', 'text-white');
                document.getElementById('reading-tab').classList.remove('bg-gray-200', 'text-gray-700');
                if (document.getElementById('reading-quiz').children.length === 0) {
                    generateReadingQuiz();
                }
            } else if (tabName === 'grammar') {
                document.getElementById('grammar-section').classList.remove('hidden');
                document.getElementById('grammar-tab').classList.add('active', 'bg-purple-500', 'text-white');
                document.getElementById('grammar-tab').classList.remove('bg-gray-200', 'text-gray-700');
            }

            activeTab = tabName;
        }

        // Initialize app
        async function initApp() {
            // Initialize SDKs
            if (window.elementSdk) {
                await window.elementSdk.init({
                    defaultConfig,
                    onConfigChange,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }

            if (window.dataSdk) {
                const result = await window.dataSdk.init(dataHandler);
                if (!result.isOk) {
                    console.error('Failed to initialize data SDK');
                }
            }

            // Set up event listeners
            document.getElementById('flip-card').addEventListener('click', flipCard);
            document.getElementById('prev-vocab').addEventListener('click', () => navigateVocab(-1));
            document.getElementById('next-vocab').addEventListener('click', () => navigateVocab(1));

            // Vocabulary mode toggle
            document.getElementById('flashcard-mode').addEventListener('click', () => switchVocabMode('flashcard'));
            document.getElementById('vocab-quiz-mode').addEventListener('click', () => switchVocabMode('quiz'));

            // Vocabulary quiz navigation
            document.getElementById('prev-vocab-question').addEventListener('click', () => navigateVocabQuiz(-1));
            document.getElementById('next-vocab-question').addEventListener('click', () => navigateVocabQuiz(1));

            // Reading mode toggle
            document.getElementById('reading-mode').addEventListener('click', () => switchReadingMode('reading'));
            document.getElementById('asean-mode').addEventListener('click', () => switchReadingMode('asean'));

            document.getElementById('vocab-tab').addEventListener('click', () => switchTab('vocab'));
            document.getElementById('reading-tab').addEventListener('click', () => switchTab('reading'));
            document.getElementById('grammar-tab').addEventListener('click', () => switchTab('grammar'));

            // Grammar topic listeners
            document.querySelectorAll('.grammar-topic').forEach(topic => {
                topic.addEventListener('click', () => {
                    const topicKey = topic.dataset.topic;
                    showGrammarTopic(topicKey);
                });
            });

            // Keyboard shortcuts (only for flashcard mode)
            document.addEventListener('keydown', (e) => {
                if (activeTab === 'vocab' && vocabMode === 'flashcard') {
                    if (e.code === 'Space') {
                        e.preventDefault();
                        flipCard();
                    } else if (e.code === 'ArrowLeft') {
                        navigateVocab(-1);
                    } else if (e.code === 'ArrowRight') {
                        navigateVocab(1);
                    }
                }
            });

            // Initialize display
            updateVocabularyDisplay();
            updateProgress();
            
            // Speak first word
            setTimeout(() => {
                speakWord(vocabularyData[0].word);
            }, 1000);
        }

        // Start the app
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9972d79156f29bda',t:'MTc2MTkxMDQ1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
